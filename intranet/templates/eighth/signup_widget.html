{% load dates %}
<div class="widget eighth-widget">
    <div class="widget-title">
        <h2>
            {% if no_signup_today %}
            <div class="warning-icon" title="You have not signed up today.">
                <i class="fa fa-exclamation-triangle"></i>
            </div>
            {% endif %}
            Upcoming Eighth Periods
        </h2>
        <div class="info">
            <a href="{% url 'eighth_signup' %}" class="ui-link">View more blocks</a>
        </div>
        
    </div>
    <div class="widget-content">
    {% for block in schedule %}
        <div class="eighth-block clickable {{ block.flags }}">
            <div class="block-header">
                <span class="block-letter"{% if block.block.letter_width %} style="width: {{ block.block.letter_width }}px"{% endif %}>
                    {{ block.block_letter }}
                </span>
                {{ block.date|date:"D, N j" }}
                {% if block.locked %}
                    {% if block.current_signup %}
                        <span class="block-signup locked{% if block.is_today %} today{% endif %}" title="{% if block.current_signup_cancelled %}Your signup was cancelled. Questions? Ask 8th Pd. Office{% else %}You have signed up for this activity.{% endif %}">
                            <i class="fa fa-lock"></i>
                            {% if block.current_signup_cancelled %}Cancelled - {% endif %}{{ block.current_signup }}
                        </span>
                    {% else %}
                         <span class="block-signup locked no-activity-selected{% if block.is_today %} today{% endif %}" title="You have not selected an activity, and signups are locked. Questions? Ask 8th Pd. Office">
                            <i class="fa fa-lock"></i>
                            No activity selected
                        </span>
                    {% endif %}
                    <a href="{% url 'eighth_signup' block.id %}" class="ui-link" title="Signups are locked.">Locked</a>
                {% elif block.current_signup %}
                    <span class="block-signup{% if block.is_today %} today{% endif %}" title="{% if block.current_signup_cancelled %}The activity you signed up for was cancelled. Click to change.{% else %}You have signed up for this activity. Click to change.{% endif %}">
                        {% if block.current_signup_cancelled %}Cancelled - {% endif %}{{ block.current_signup }}
                    </span>
                    <a href="{% url 'eighth_signup' block.id %}" class="ui-link" title="Click to change.">Change</a>
                {% else %}
                    <span class="block-signup no-activity-selected{% if block.is_today %} today{% endif %}" title="You have not selected an activity. Click to change.">
                        No activity selected
                    </span>
                    <a href="{% url 'eighth_signup' block.id %}" class="ui-link" title="Click to sign up.">Sign Up</a>
                {% endif %}
            </div>
            {% if block.is_today and block.signup_time %}
                <div class="block-timeleft">
                    {% if block.signup_time_future %}
                        Signups close <b>{{ block.signup_time|fuzzy_time }}</b> ({{ block.signup_time }})
                    {% else %}
                        {% if block.locked %}
                            Signups are <b>locked</b>. Questions? Visit 8th Pd. Office
                        {% else %}
                            Signups are <b>closing</b>. Questions? Visit 8th Pd. Office
                        {% endif %}
                    {% endif %}
                </div>
            {% endif %}
            {% if block.current_signup_cancelled %}
                <div class="block-info">
                    <i class="fa fa-info-circle"></i> This activity was cancelled. {% if block.locked %}Visit 8th Pd. Office{% else %}Select another activity.{% endif %}
                </div>
            {% endif %}
        </div>
    {% empty %}
        <div class="eighth-block">
            <div class="block-header">
            There are no blocks available at this time.
            </div>
        </div>
    {% endfor %}
    </div>
</div>